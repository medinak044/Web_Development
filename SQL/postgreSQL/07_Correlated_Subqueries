-- Finds average salary per department and compares employee salary to average salary
SELECT 		
first_name,
salary,
(SELECT ROUND(AVG(salary)) FROM employees e2 WHERE e1.department = e2.department) 
	AS avg_department_salary,
(salary - (SELECT ROUND(AVG(salary)) FROM employees e2 WHERE e1.department = e2.department)) 
	AS difference,
department
FROM employees e1;

-- Finds all departments with more than 38 employees, and shows highest salary for each department
SELECT d.department, (SELECT MAX(salary) FROM employees WHERE department = d.department)
FROM departments d
WHERE 38 < (SELECT COUNT(*) FROM employees e
		   WHERE e.department = d.department);
-- ^The query below displays the same result as the query above
SELECT department, MAX(salary)
FROM employees
GROUP BY department;